<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: head}"></head>

<body th:with="activePage='applications'">

<div th:replace="~{fragments/sidebar :: sidebar}"></div>

<main class="main-content">
    <div class="container">

        <div class="page-header">
            <div>
                <a href="/applications" style="color: var(--text-secondary); text-decoration: none; display: inline-flex; align-items: center; gap: 5px; margin-bottom: 10px;">
                    <i class="fas fa-arrow-left"></i> Zurück zur Liste
                </a>
                <h1 class="page-title" th:text="${appDetails.companyName}">Firma</h1>
                <p style="color: var(--text-secondary);" th:text="${appDetails.position}">Position</p>
            </div>

            <div style="display: flex; gap: 10px;">
                <a th:href="@{/applications/{id}/edit(id=${appDetails.id})}" class="btn btn-primary">
                    <i class="fas fa-pen"></i> Bearbeiten
                </a>
                <form th:action="@{/applications/{id}/delete(id=${appDetails.id})}" method="post" onsubmit="return confirm('Wirklich löschen?');">
                    <button type="submit" class="btn btn-secondary" style="color: #ef4444; background: #fee2e2;">
                        <i class="fas fa-trash"></i>
                    </button>
                </form>
            </div>
        </div>

        <div class="detail-grid">

            <div style="display: flex; flex-direction: column; gap: 30px;">
                <div class="card">
                    <div class="card-header"><h2 class="card-title">Details</h2></div>
                    <div class="card-body">
                        <div class="form-section">
                            <label class="form-label">Status</label>
                            <span th:class="'status-badge status-' + ${#strings.toLowerCase(appDetails.status)}"
                                  th:text="${appDetails.status.displayName}">Status</span>
                        </div>

                        <div class="form-section">
                            <label class="form-label">Link zur Stelle</label>
                            <a th:if="${appDetails.jobUrl}" th:href="${appDetails.jobUrl}" target="_blank" style="color: var(--primary-color);">
                                Öffnen <i class="fas fa-external-link-alt" style="font-size: 0.8rem;"></i>
                            </a>
                            <span th:unless="${appDetails.jobUrl}">-</span>
                        </div>

                        <div class="form-section">
                            <label class="form-label">Gehalt</label>
                            <p th:text="${appDetails.salaryExpectation != null} ? ${appDetails.salaryExpectation} + ' €' : '-'">0 €</p>
                        </div>

                        <div class="form-section">
                            <label class="form-label">Notizen</label>
                            <div style="background: #f9fafb; padding: 15px; border-radius: 8px; white-space: pre-wrap;"
                                 th:text="${appDetails.notes} ?: 'Keine Notizen'"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="display: flex; flex-direction: column; gap: 30px;">
                <div class="card">
                    <div class="card-header"><h2 class="card-title">Kontakt</h2></div>
                    <div class="card-body">
                        <p><strong>Name:</strong> <span th:text="${appDetails.contactPerson} ?: '-'">-</span></p>

                        <p><strong>Email:</strong>
                            <a th:if="${appDetails.contactEmail}" th:href="'mailto:' + ${appDetails.contactEmail}" th:text="${appDetails.contactEmail}"></a>
                            <span th:unless="${appDetails.contactEmail}">-</span>
                        </p>

                        <p><strong>Tel:</strong>
                            <a th:if="${appDetails.contactPhone}" th:href="'tel:' + ${appDetails.contactPhone}" th:text="${appDetails.contactPhone}"></a>
                            <span th:unless="${appDetails.contactPhone}">-</span>
                        </p>
                    </div>
                </div>

                <div class="card" th:if="${appDetails.deadline}">
                    <div class="card-body" style="background: #fffbeb; border: 1px solid #fcd34d; border-radius: 12px;">
                        <h4 style="margin: 0 0 5px 0; color: #92400e;">Deadline</h4>
                        <p style="margin: 0; font-weight: 700;" th:text="${#temporals.format(appDetails.deadline, 'dd.MM.yyyy')}"></p>
                    </div>
                </div>
            </div>

        </div>
    </div>
</main>

<div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>